const XLSX = require('xlsx'); 

//let inputData = [[["the", 0.03, 0.11], ["diving", 0.11, 0.52], ["board", 0.52, 0.87], ["was", 0.87, 1.06], ["high", 1.06, 1.67], ["and", 1.7, 1.89], ["maybe", 1.89, 2.26], ["a", 2.26, 2.34], ["little", 2.34, 2.6], ["scary", 2.6, 3.24], ["budget", 3.66, 4], ["Bari", 4, 4.34], ["had", 4.34, 4.54], ["finished", 4.54, 4.99], ["his", 4.99, 5.15], ["swimming", 5.15, 5.53], ["lessons", 5.53, 6.05], ["and", 6.2, 6.42], ["passed", 6.42, 6.79], ["his", 6.79, 6.94], ["swim", 6.94, 7.2], ["test", 7.2, 7.65], ["and", 8.12, 8.4], ["now", 8.4, 8.92], ["he", 8.97, 9.14], ["was", 9.14, 9.33], ["ready", 9.33, 9.7], ["to", 9.7, 9.85], ["jump", 9.85, 10.35]]]; 

let inputData = [[["so",2.04,2.21],["in",2.21,2.37],["the",2.37,2.46],["last",2.46,2.72],["video",2.72,3],["you",3,3.17],["learned",3.17,3.56],["that",3.67,3.87],["note",3.87,4.23],["it's",4.26,4.42],["a",4.42,4.52],["run",4.52,4.8],["time",4.8,5.05],["environment",5.05,5.69],["executing",5.98,6.7],["Java",6.7,7.1],["script",7.1,7.38],["code",7.38,7.65],["but",8.08,8.28],["what",8.28,8.4],["is",8.4,8.5],["a",8.5,8.58],["runtime",8.58,8.98],["environment",8.98,9.43],["friendly",9.43,9.84],["well",10.3,10.7],["before",11.11,11.44],["note",11.44,11.74],["use",11.77,12.01],["Java",12.01,12.41],["script",12.41,12.78],["only",13.06,13.35],["to",13.35,13.5],["build",13.5,13.78],["applications",13.81,14.54],["that",14.73,14.92],["run",14.92,15.28],["inside",15.39,15.85],["of",15.85,15.97],["a",15.97,16.04],["browser",16.04,16.56]],[["every",17.45,17.64],["browser",17.64,18.07],["out",18.07,18.32],["there",18.32,18.62],["has",18.76,18.97],["what",18.97,19.21],["we",19.21,19.3],["call",19.3,19.68],["it",19.91,20.09],["Java",20.15,20.54],["script",20.54,20.82],["engine",20.85,21.39],["that",21.79,21.99],["takes",21.99,22.31],["our",22.34,22.46],["Java",22.46,22.87],["script",22.87,23.11],["code",23.11,23.47],["and",23.8,24.01],["converts",24.01,24.5],["it",24.5,24.66],["to",24.66,24.77],["coat",24.77,25.22],["that",25.22,25.36],["a",25.36,25.41],["computer",25.41,25.98],["can",25.98,26.16],["understand",26.16,26.7]],[["for",27.26,27.37],["example",27.37,27.91],["Microsoft",28.11,28.68],["edge",28.68,29.06],["uses",29.18,29.53],["Chaka",29.53,30.14],["Firefox",30.43,31],["use",31,31.2],["as",31.2,31.43],["spider",31.6,32.09],["monkey",32.09,32.63],["and",32.88,33.07],["chrome",33.07,33.4],["uses",33.4,33.79],["V.",33.79,34.04],["eight",34.04,34.37],["and",35.05,35.18],["it's",35.18,35.26],["because",35.26,35.61],["of",35.61,35.73],["these",35.73,35.89],["varieties",35.89,36.68],["of",36.71,36.9],["engines",36.99,37.64],["that",37.82,38.03],["sometimes",38.03,38.56],["Java",38.62,39.01],["script",39.01,39.27],["code",39.27,39.56],["can",39.56,39.75],["behave",39.75,40.3],["differently",40.49,41.11],["in",41.11,41.3],["one",41.3,41.51],["browser",41.51,41.91],["or",41.91,42.04],["another",42.04,42.5],["now",43.13,43.34],["the",43.61,43.71],["browser",43.71,44.22],["provides",44.22,44.72],["and",44.78,44.97],["runtime",44.97,45.36],["environment",45.36,45.94],["for",46.1,46.21],["Java",46.21,46.64],["script",46.64,46.92],["code",46.92,47.17],["for",47.69,47.81],["example",47.81,48.26],["you",48.26,48.41],["probably",48.41,48.8],["know",48.8,49.16],["that",49.42,49.6],["in",49.6,49.71],["browsers",49.71,50.41],["we",50.44,50.55],["have",50.55,50.77],["the",50.77,50.88],["window",50.88,51.47],["or",51.5,51.65],["the",51.65,51.73],["document",51.73,52.36],["object",52.39,52.99]],[["these",53.48,53.74],["objects",53.77,54.35],["allow",54.38,54.69],["us",54.69,54.95],["to",55.14,55.25],["work",55.25,55.56],["with",55.59,55.71],["the",55.71,55.83],["environment",55.87,56.56],["in",56.59,56.74],["which",56.74,57.09],["our",57.12,57.26],["code",57.26,57.65],["is",57.68,57.86],["right",57.86,58.17],["now",58.73,58.93],["up",58.96,59.11],["to",59.11,59.21],["two",59.21,59.45],["thousand",59.45,59.81],["and",59.81,59.9],["nine",59.9,60.19],["only",60.64,60.96],["way",60.96,61.16],["to",61.16,61.32],["execute",61.32,61.87],["Java",61.87,62.24],["script",62.24,62.48],["code",62.48,62.79],["was",63.02,63.27],["inside",63.31,63.82],["of",63.85,63.96],["a",63.96,64.02],["browser",64.02,64.46]],[["in",65.1,65.25],["two",65.25,65.41],["thousand",65.41,65.74],["and",65.74,65.85],["nine",65.85,66.18],["Bryant",66.48,66.96],["all",66.96,67.32],["the",67.37,67.49],["creator",67.49,67.91],["of",67.91,68.02],["note",68.02,68.37],["came",68.6,68.9],["up",68.9,69.1],["with",69.1,69.22],["a",69.22,69.27],["brilliant",69.27,69.99],["idea",70.02,70.5]],[["he",71.18,71.29],["thought",71.29,71.56],["it",71.56,71.68],["would",71.68,71.81],["be",71.81,71.9],["great",71.9,72.29],["to",72.29,72.43],["execute",72.46,73.01],["Java",73.01,73.37],["script",73.37,73.76],["outside",73.86,74.31],["of",74.31,74.37],["a",74.37,74.44],["browser",74.44,74.95],["so",75.32,75.53],["he",75.53,75.68],["took",75.68,75.94],["Google's",76.11,76.69],["V.",76.79,77.02],["eight",77.02,77.27],["engine",77.3,77.81],["which",77.84,78],["is",78,78.12],["the",78.12,78.21],["fastest",78.21,79.02],["Java",79.07,79.45],["script",79.45,79.71],["engine",79.75,80.12],["out",80.12,80.33],["there",80.33,80.63],["and",81.03,81.22],["invented",81.3,81.85],["it",81.85,82.09],["inside",82.27,82.8],["his",82.84,82.99],["C.",82.99,83.18],["plus",83.18,83.45],["plus",83.45,83.71],["program",83.71,84.28],["and",84.36,84.53],["called",84.53,84.86],["a",84.86,84.94],["program",84.94,85.51],["note",85.76,86.09],["so",86.75,86.87],["similar",86.87,87.27],["to",87.27,87.38],["the",87.38,87.46],["browser",87.46,88.12],["known",88.38,88.75],["as",88.86,88.97],["the",88.97,89.09],["runtime",89.09,89.52],["environment",89.52,90.12],["for",90.12,90.27],["Java",90.27,90.71],["script",90.71,90.97],["code",90.97,91.22],["its",91.72,91.87],["content",91.87,92.31],["it",92.34,92.47],["Java",92.47,92.83],["script",92.83,93.07],["engine",93.1,93.6],["can",93.7,94],["execute",94.06,94.72],["our",94.8,94.96],["Java",94.96,95.3],["script",95.3,95.57],["code",95.57,95.78],["but",96.23,96.4],["it",96.4,96.52],["also",96.56,96.94],["has",96.94,97.27],["certain",97.35,97.8],["objects",97.89,98.43],["that",98.43,98.64],["provide",98.64,99.1],["an",99.13,99.32],["environment",99.36,100.17],["for",100.33,100.56],["Java",100.56,100.97],["script",100.97,101.23],["code",101.23,101.48]]];
let headers = ["Title", "StartTime", "EndTime"]; 
let newInput = [];
for(let i = 0; i<=inputData.length-1; i++){
    newInput = newInput.concat(inputData[i]);
}
for (let j = 0; j <= newInput.length-1; j++) {

    if (newInput[j][1] <= 10) {
        newInput[j][1] = "00:00:0" + newInput[j][1];
    } else {
        newInput[j][1] = "00:00:" + newInput[j][1];
    }
    if (newInput[j][2] <= 10) {
        newInput[j][2] = "00:00:0" + newInput[j][2];
    } else {
        newInput[j][2] = "00:00:" + newInput[j][2];
    }
}

newInput.splice(0, 0, headers); 
let data = newInput; 
let ws = XLSX.utils.aoa_to_sheet(data); 
    let wb = XLSX.utils.book_new(); 
    XLSX.utils.book_append_sheet(wb, ws, "Output"); 
    XLSX.writeFile(wb, 'output.xlsx',  {type:'buffer', bookType:"xlsx"}); 
    console.log("Output xls has been created successfully!!!!")